<!-- loio7c9a0fd3f264441083286252b6c1d057 -->

# XI Sender Adapter Handles Duplicates

The receiver isn't idempotent, but the sender XI adapter handles duplicates.

The XI adapter provides the following features:

-   It has an in-built retry mechanism.

-   It also stores the incoming XI message ID in an idempotent repository. If another message with the same XI message ID arrives at the XI endpoint, the message is discarded.


The *Pattern Quality Of Service - Scenario 05* integration flow illustrates this scenario.

> ### Note:  
> You find an analog scenario under [Sender and Receiver with SAP RM Protocol](sender-and-receiver-with-sap-rm-protocol-9f3e2b6.md).
> 
> However, instead of using the SAP RM adapter for both sender and receiver side, the scenario uses:
> 
> -   XI protocol at sender side
> 
> -   SOAP 1.x protocol at receiver side
> 
> 
> Already during integration flow inbound processing, the XI sender adapter discards duplicate messages from the sender system.
> 
> The *Generic Receiver* is designed in such a way that when a message is sent to its SOAP 1.x endpoint, duplicates aren't discarded.

![](images/Scenario_with_XI_Sender_Adapter_0ecd927.png)

The integration flow performs the following steps:

1.  The XI adapter processes the inbound message using the following *Delivery Assurance* parameters:


    <table>
    <tr>
    <th valign="top">

    Parameter


    
    </th>
    <th valign="top">

    Setting


    
    </th>
    </tr>
    <tr>
    <td valign="top">
    
    *Quality Of Service* 


    
    </td>
    <td valign="top">
    
    *Exactly Once* 


    
    </td>
    </tr>
    <tr>
    <td valign="top">
    
    *Temporary Storage* 


    
    </td>
    <td valign="top">
    
    *Data Store* 


    
    </td>
    </tr>
    </table>
    
    See: [Configure the XI Sender Adapter](configure-the-xi-sender-adapter-41a1a57.md)

2.  At receiver side, the SOAP 1.x receiver adapter is used \(see: [Configure the SOAP \(SOAP 1.x\) Receiver Adapter](configure-the-soap-soap-1-x-receiver-adapter-57f7b34.md)\).


To test the scenario, perform the following steps:

1.  Set up inbound *Basic* authentication for integration flow endpoints.

    See:

    [Basic Authentication with clientId and clientsecret for Integration Flow Processing](../ConnectionSetup/basic-authentication-with-clientid-and-clientsecret-for-integration-flow-processing-647eeb3.md)

    [Setting Up Inbound HTTP Connections \(with Basic Authentication\), Neo Environment](../ConnectionSetup/setting-up-inbound-http-connections-with-basic-authentication-neo-environment-391c45c.md)

2.  Deploy a *User Credentials* artifact with the following parameters using the *Monitor* application \(*Security Material* tile under *Manage Security*\).


    <table>
    <tr>
    <th valign="top">

    Parameter


    
    </th>
    <th valign="top">

    Setting


    
    </th>
    </tr>
    <tr>
    <td valign="top">
    
    *Name*


    
    </td>
    <td valign="top">
    
    `OWN`


    
    </td>
    </tr>
    <tr>
    <td valign="top">
    
    *User*


    
    </td>
    <td valign="top">
    
    Enter the user as specified when setting up inbound basic authentication.


    
    </td>
    </tr>
    <tr>
    <td valign="top">
    
    *Password*


    
    </td>
    <td valign="top">
    
    Enter the password as specified when setting up inbound basic authentication.


    
    </td>
    </tr>
    </table>
    
    > ### Note:  
    > When you check out the integration flows *Pattern Quality Of Service – Mocked Sender* and *Pattern Quality Of Service - Scenario 05*, you notice that the receiver adapters refer to a *User Credentials* artifact with the name *OWN*.
    > 
    > Both integration flows operate on the same tenant and use the same user credentials for inbound requests.

3.  Deploy all 3 integration flows *Generic Receiver*, *Pattern Quality Of Service – Mocked Sender*, and *Pattern Quality Of Service - Scenario 05*.

4.  In the Postman client, open the *QualityOfService* folder in the *Enterprise Integration Patterns* collection, and run the *QualityOfService – Scenario 05* request.

    If you set the request parameter `sendDuplicates` to `true` \(in the *Params* tab of Postman\), the *Pattern Quality Of Service – Mocked Sender* integration flow sends a second message to the *Pattern Quality Of Service - Scenario 05* integration flow with a delay of 5 seconds.

5.  Once the system has processed the 2nd message successfully, check the data store *Pattern-QualityOfService* \(open the *Monitor* application and select the *Data Stores* tile under *Manage Stores*\).

    > ### Tip:  
    > You see only 1 entry with an entry ID that is automatically generated by the data store write operation.

6.  Before rerunning the test, clean up the data store.

7.  Optionally, you can switch on the trace to be able to verify the overall behavior.


**Related Information**  


[Configure the XI Sender Adapter](configure-the-xi-sender-adapter-41a1a57.md "The XI sender adapter allows you to connect a tenant to a local Integration Engine in a sender system.")

[Configure the SOAP \(SOAP 1.x\) Receiver Adapter](configure-the-soap-soap-1-x-receiver-adapter-57f7b34.md "The SOAP (SOAP 1.x) receiver adapter enables a SAP BTP tenant to exchange messages with a receiver system that supports Simple Object Access Protocol (SOAP) 1.1.")

